# Docker é•œåƒå¿«é€Ÿå‚è€ƒå¡ç‰‡

## ğŸ“¦ é•œåƒåœ°å€

```bash
# åç«¯é•œåƒ
ghcr.io/<ä½ çš„GitHubç”¨æˆ·å>/soybean-admin/backend:latest

# å‰ç«¯é•œåƒ
ghcr.io/<ä½ çš„GitHubç”¨æˆ·å>/soybean-admin/frontend:latest
```

> **é‡è¦**ï¼šå°† `<ä½ çš„GitHubç”¨æˆ·å>` æ›¿æ¢ä¸ºå®é™…ç”¨æˆ·åï¼ˆä¾‹å¦‚ï¼šollma167ï¼‰

---

## âš¡ ä¸€é”®å¯åŠ¨

### ä½¿ç”¨ docker-composeï¼ˆæ¨èï¼‰

```bash
# 1. åˆ›å»ºé…ç½®æ–‡ä»¶ docker-compose.prod.yml
wget https://raw.githubusercontent.com/<ä½ çš„ç”¨æˆ·å>/soybean-admin/feat-split-front-back-python-docker-mysql-redis/docker-compose.yml -O docker-compose.prod.yml

# 2. ä¿®æ”¹é•œåƒåœ°å€ï¼ˆå°† build æ”¹ä¸º imageï¼‰
# ç¼–è¾‘ docker-compose.prod.ymlï¼š
#   backend:
#     image: ghcr.io/<ä½ çš„ç”¨æˆ·å>/soybean-admin/backend:latest
#   frontend:
#     image: ghcr.io/<ä½ çš„ç”¨æˆ·å>/soybean-admin/frontend:latest

# 3. å¯åŠ¨æœåŠ¡
docker-compose -f docker-compose.prod.yml up -d

# 4. æŸ¥çœ‹çŠ¶æ€
docker-compose -f docker-compose.prod.yml ps
```

### ä½¿ç”¨ docker run

```bash
# 1. åˆ›å»ºç½‘ç»œ
docker network create combo-network

# 2. å¯åŠ¨ MySQL
docker run -d --name combo-mysql --network combo-network \
  -e MYSQL_ROOT_PASSWORD=rootpassword \
  -e MYSQL_DATABASE=combo_db \
  -e MYSQL_USER=combo_user \
  -e MYSQL_PASSWORD=combo_password \
  -p 3306:3306 \
  mysql:8.0

# 3. å¯åŠ¨ Redis
docker run -d --name combo-redis --network combo-network \
  -p 6379:6379 \
  redis:7-alpine

# 4. å¯åŠ¨åç«¯
docker run -d --name combo-backend --network combo-network \
  -p 8000:8000 \
  -e DATABASE_URL=mysql+pymysql://combo_user:combo_password@combo-mysql:3306/combo_db \
  -e REDIS_URL=redis://combo-redis:6379/0 \
  -e SECRET_KEY=your-secret-key \
  ghcr.io/<ä½ çš„ç”¨æˆ·å>/soybean-admin/backend:latest

# 5. å¯åŠ¨å‰ç«¯ï¼ˆå¯é€‰ï¼‰
docker run -d --name combo-frontend --network combo-network \
  -p 80:80 \
  ghcr.io/<ä½ çš„ç”¨æˆ·å>/soybean-admin/frontend:latest
```

---

## ğŸ” é•œåƒè®¤è¯

### å…¬å¼€é•œåƒï¼ˆæ— éœ€è®¤è¯ï¼‰

```bash
docker pull ghcr.io/<ä½ çš„ç”¨æˆ·å>/soybean-admin/backend:latest
```

### ç§æœ‰é•œåƒï¼ˆéœ€è¦è®¤è¯ï¼‰

```bash
# 1. åˆ›å»º GitHub Token
# è®¿é—®ï¼šhttps://github.com/settings/tokens
# æƒé™ï¼šread:packages

# 2. ç™»å½•
echo "YOUR_TOKEN" | docker login ghcr.io -u YOUR_USERNAME --password-stdin

# 3. æ‹‰å–é•œåƒ
docker pull ghcr.io/<ä½ çš„ç”¨æˆ·å>/soybean-admin/backend:latest
```

---

## ğŸŒ æœåŠ¡è®¿é—®

| æœåŠ¡ | åœ°å€ |
|------|------|
| åç«¯ API | http://localhost:8000 |
| API æ–‡æ¡£ | http://localhost:8000/docs |
| å¥åº·æ£€æŸ¥ | http://localhost:8000/api/health |
| å‰ç«¯ | http://localhost |

---

## ğŸ› ï¸ å¸¸ç”¨å‘½ä»¤

```bash
# æŸ¥çœ‹æ—¥å¿—
docker logs -f combo-backend

# æŸ¥çœ‹çŠ¶æ€
docker ps

# è¿›å…¥å®¹å™¨
docker exec -it combo-backend bash

# é‡å¯æœåŠ¡
docker restart combo-backend

# åœæ­¢æ‰€æœ‰
docker-compose -f docker-compose.prod.yml down

# æ›´æ–°é•œåƒ
docker-compose -f docker-compose.prod.yml pull
docker-compose -f docker-compose.prod.yml up -d
```

---

## âš™ï¸ å¿…éœ€çš„ç¯å¢ƒå˜é‡

```bash
DATABASE_URL=mysql+pymysql://combo_user:combo_password@mysql:3306/combo_db
REDIS_URL=redis://redis:6379/0
SECRET_KEY=your-secret-key-change-in-production
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
```

---

## ğŸ” å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥åç«¯
curl http://localhost:8000/api/health/ping

# æ£€æŸ¥æ•°æ®åº“
docker exec combo-mysql mysqladmin ping -h localhost -u combo_user -pcombo_password

# æ£€æŸ¥ Redis
docker exec combo-redis redis-cli ping
```

---

## ğŸ“Š é•œåƒæ ‡ç­¾

| æ ‡ç­¾ | è¯´æ˜ |
|------|------|
| `latest` | æœ€æ–°ç‰ˆæœ¬ï¼ˆmain åˆ†æ”¯ï¼‰ |
| `feat-*` | åŠŸèƒ½åˆ†æ”¯ç‰ˆæœ¬ |
| `sha-*` | ç‰¹å®šæäº¤ç‰ˆæœ¬ |
| `v*` | ç‰ˆæœ¬å·æ ‡ç­¾ |

---

## ğŸ› å¿«é€Ÿæ•…éšœæ’é™¤

```bash
# æŸ¥çœ‹æ—¥å¿—
docker logs combo-backend

# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps -a

# é‡å¯å®¹å™¨
docker restart combo-backend

# æ£€æŸ¥ç½‘ç»œ
docker network inspect combo-network

# æ¸…ç†å¹¶é‡å¯
docker-compose -f docker-compose.prod.yml down
docker-compose -f docker-compose.prod.yml up -d
```

---

## ğŸ“ å®Œæ•´æ–‡æ¡£

- [è¯¦ç»†ä½¿ç”¨æŒ‡å—](DOCKERé•œåƒä½¿ç”¨æŒ‡å—.md)
- [å¿«é€Ÿå¼€å§‹](QUICK_START.md)
- [éƒ¨ç½²æ–‡æ¡£](DEPLOYMENT.md)
- [ä½¿ç”¨è¯´æ˜](ä½¿ç”¨è¯´æ˜.md)

---

**æç¤º**ï¼šé¦–æ¬¡ä½¿ç”¨è¯·æŸ¥çœ‹ [DOCKERé•œåƒä½¿ç”¨æŒ‡å—.md](DOCKERé•œåƒä½¿ç”¨æŒ‡å—.md) è·å–å®Œæ•´è¯´æ˜ã€‚
